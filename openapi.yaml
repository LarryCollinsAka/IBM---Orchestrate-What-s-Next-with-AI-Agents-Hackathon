openapi: 3.0.0
info:
  title: "AgroSphere Localized Agent Skills"
  version: "3.0.0"
  description: "Localized skills (v3) for the AgroSphere Agent with local currency."

servers:
  - url: https://ibm-orchestrate-what-s-next-with-ai.vercel.app #Vercel URL
    description: "Localized Mock API Server (Vercel)"

paths:
  # --- INTERNAL SKILLS ---
  /process:
    get:
      summary: "Get Local Crop Processing Options"
      description: "Gets localized processing options, profit, and equipment for a specific crop and country."
      operationId: "getProcessingOptions"
      parameters:
        - name: crop_name
          in: query
          required: true
          schema: { "type": "string" }
          description: "The name of the raw crop (e.g., 'Cassava', 'Maize', 'Rice')."
        - name: country
          in: query
          required: true
          schema: { "type": "string" }
          description: "The country of operation (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "A list of localized processing options."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ProcessingOption" 

  /finance:
    get:
      summary: "Find Local Equipment Financing"
      description: "Given a COUNTRY, finds local micro-finance (MFI) and digital inclusion options."
      operationId: "getFinanceOptions"
      parameters:
        - name: country
          in: query
          required: true
          schema: { "type":"string" }
          description: "The country to search for financing in (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "A list of localized financing options."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/FinanceOption" 

  /market:
    get:
      summary: "Get Local Market Price for Processed Good"
      description: "Given a processed product and COUNTRY, gets the current market price in local currency."
      operationId: "getMarketPrice"
      parameters:
        - name: product_name
          in: query
          required: true
          schema: { "type": "string" }
          description: "The name of the processed product (e.g., 'Gari', 'Puffed Rice')."
        - name: country
          in: query
          required: true
          schema: { "type": "string" }
          description: "The country to get the price for (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "Market price and buyer information in local currency."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MarketData"

# 'components/schemas'
components:
  schemas:
    ProcessingOption:
      type: object
      properties:
        option_name: { "type": "string" }
        output_yield_kg: { "type": "integer" }
        equipment_needed: { "type": "string" }
        est_profit_local: { "type": "string" }
        local_currency_code: { "type": "string" }
    FinanceOption:
      type: object
      properties:
        funder_name: { "type": "string" }
        loan_details: { "type": "string" }
        contact_url: { "type": "string" }
    MarketData:
      type: object
      properties:
        product: { "type": "string" }
        current_price_local: { "type": "string" }
        local_currency_code: { "type": "string" }
        top_buyer: { "type":Two-step plan:**
    1.  **Delete** all tools from your `AgroSphere` agent in Orchestrate.
    2.  **Import** this new `openapi.yaml` (v3) file.

This reverts us to our 100% stable, working build.

---

### ## Step 3: Finalize the "Brain"

Now we put all the logic into our `AgroSphere Agent`.

1.  **Remove the Broken Agent:** Go to the **"Toolset"** tab and **DELETE** the "AgroSphere Advisor" collaborator. It is the source of our bug.
2.  **Add Knowledge (The "Advisor"):** Go to the **"Knowledge"** tab and **UPLOAD ALL YOUR PDFs.** This is now our "Planting, Harvesting, and Storage Advisor."
3.  **Set the Master Prompt:** Go to the **"Behavior"** tab, delete any "Guidelines," and in the main **"Instructions"** box, paste our **stable v8 prompt**:

    ```
    <role>
    You are AgroSphere, an expert AI advisor for smallholder farmers. Your primary goal is to provide clear, practical, and profitable advice to improve their livelihood.
    </role>
    <rules>
    * **CRITICAL (Location):** You MUST know the user's location (country and region) before giving advice. If you don't know the location, you MUST ask for it first.
    * **RULE 1 (PROCESSING & FINANCE):**
    For ANY question about "processing," "value-add," "profit," "equipment," or "local finance," you MUST use your **Custom Processing Tool** (e.g., `getProcessingOptions`, `getFinanceOptions`).
    * **RULE 2 (PLANTING & FARMING):**
    For ANY question about "planting," "harvesting," "storage," "climate," or "land use," you MUST search your "Knowledge" (the PDFs you have been given).
    * **CRITICAL (Currency):** ALL financial answers (profit, price) MUST be given in the **local currency (NGN, XAF, INR)**.
    * **Honesty:** If you cannot find an answer, apologize.
    </routes>
    <output_format>
    * **Format:** You MUST format your final, combined answer using Markdown headings and bullet points for clarity.
    * **Citations:** You MUST cite the source of your information (e.g., "(Source: CASSAVA-Production.pdf)").
    </output_format>
    ```

---


This is it. Our agent is stable. It has Voice, Processing, and RAG (PDFs).

Go to the **"Preview"** panel and **record your demo video** with these prompts:

1.  **(Voice üéôÔ∏è):** "What are the processing options for 30 tonnes of Plantain in Cameroon?"
2.  **(Voice üéôÔ∏è):** "What are the planting guidelines for cassava?"
3.  **(Voice üéôÔ∏è):** "What financing options are there in Nigeria?"

This is our stable, final build. We must stop experimenting and **record this demo now.**