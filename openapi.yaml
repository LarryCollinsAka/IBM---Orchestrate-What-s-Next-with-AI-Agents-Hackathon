# =============================================================
# openapi.yaml
# =============================================================
# NEW: Updated to use localized currency and added 'country' to /market
#
openapi: 3.0.0
info:
  title: "AgroSphere Localized Agent Skills"
  version: "1.2.0" 
  description: "Localized skills for the AgroSphere Agent with local currency."

servers:
  - url: https://ibm-orchestrate-what-s-next-with-ai.vercel.app # Your Vercel URL
    description: "Localized Mock API Server (Vercel)"

paths:
  # Skill 1: Processing Planner 
  /process:
    get:
      summary: "Get Local Crop Processing Options"
      description: "Given a crop type, quantity, and COUNTRY, return localized processing options (with local currency)."
      operationId: "getProcessingOptions"
      parameters:
        - name: crop_name
          in: query
          required: true
          schema: { "type": "string" }
          description: "The name of the raw crop (e.g., 'Cassava', 'Maize', 'Rice')."
        - name: quantity_kg
          in: query
          required: true
          schema: { "type": "integer" }
          description: "The quantity of the raw crop in kilograms."
        - name: country
          in: query
          required: true
          schema: { "type": "string" }
          description: "The country of operation (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "A list of localized processing options."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ProcessingOption" 

  # Skill 2: Finance Finder 
  /finance:
    get:
      summary: "Find Local Equipment Financing"
      description: "Given a COUNTRY, finds local micro-finance (MFI) and digital inclusion options."
      operationId: "getFinanceOptions"
      parameters:
        - name: country
          in: query
          required: true
          schema: { "type": "string" }
          description: "The country to search for financing in (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "A list of localized financing options."
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/FinanceOption" 

  # Skill 3: Market Access
  /market:
    get:
      summary: "Get Local Market Price for Processed Good"
      description: "Given a processed product and COUNTRY, gets the current market price in local currency."
      operationId: "getMarketPrice"
      parameters:
        - name: product_name
          in: query
          required: true
          schema: { "type": "string" }
          description: "The name of the processed product (e.g., 'Gari', 'Puffed Rice')."
        - name: country
          in: query
          required: true
          schema: { "type": "string" }
          description: "The country to get the price for (e.g., 'Cameroon', 'Nigeria', 'India')."
      responses:
        '200':
          description: "Market price and buyer information in local currency."
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MarketData" # 

# 'components/schemas'
components:
  schemas:
    ProcessingOption:
      type: object
      properties:
        option_name:
          type: string
        output_yield_kg:
          type: integer
        equipment_needed:
          type: string
        est_profit_local: # NEW
          type: string
        local_currency_code: # NEW
          type: string
    FinanceOption:
      type: object
      properties:
        funder_name:
          type: string
        loan_details:
          type: string
        contact_url:
          type: string
    MarketData: # UPDATED
      type: object
      properties:
        product:
          type: string
        current_price_local: # NEW
          type: string
        local_currency_code: # NEW
          type: string
        top_buyer:
          type: string